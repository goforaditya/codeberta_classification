2024-12-14 12:49:20,081 - INFO - Initializing CodeBERTa classifier...
2024-12-14 12:49:20,109 - INFO - Using device: cuda
2024-12-14 12:49:21,406 - INFO - Trainable parameters: 14,772,488 (17.70%)
2024-12-14 12:49:21,407 - INFO - Model initialized with config: ModelConfig(model_name='huggingface/CodeBERTa-small-v1', max_length=512, batch_size=16, epochs=3, learning_rate=2e-05, warmup_ratio=0.1, max_grad_norm=1.0, early_stopping_patience=3, validation_split=0.1, freeze_base_model=True, unfreeze_last_n_layers=2, weight_decay=0.01, dropout=0.1, gradient_accumulation_steps=1)
2024-12-14 12:49:21,407 - INFO - Preparing data from FileTypeData directory...
2024-12-14 12:49:22,935 - INFO - 
Files processed per language:
2024-12-14 12:49:22,935 - INFO - cpp: 309 files
2024-12-14 12:49:22,935 - INFO - groovy: 86 files
2024-12-14 12:49:22,935 - INFO - java: 592 files
2024-12-14 12:49:22,935 - INFO - javascript: 595 files
2024-12-14 12:49:22,935 - INFO - json: 6368 files
2024-12-14 12:49:22,935 - INFO - python: 474 files
2024-12-14 12:49:22,936 - INFO - xml: 6654 files
2024-12-14 12:49:22,936 - INFO - yml: 6903 files
2024-12-14 12:49:22,975 - INFO - Training samples: 17584
2024-12-14 12:49:22,975 - INFO - Testing samples: 4397
2024-12-14 12:49:24,496 - INFO - Epoch 1 | Batch 0/990 | Loss: 2.1838 | Accuracy: 0.0000 | Time: 1.52s
2024-12-14 12:50:14,705 - INFO - Epoch 1 | Batch 50/990 | Loss: 1.7411 | Accuracy: 0.2353 | Time: 51.72s
2024-12-14 12:50:58,874 - INFO - Epoch 1 | Batch 100/990 | Loss: 1.0625 | Accuracy: 0.4988 | Time: 95.89s
2024-12-14 12:51:23,382 - INFO - Epoch 1 | Batch 150/990 | Loss: 0.2721 | Accuracy: 0.6250 | Time: 120.40s
2024-12-14 12:51:52,836 - INFO - Epoch 1 | Batch 200/990 | Loss: 0.2157 | Accuracy: 0.7006 | Time: 149.86s
2024-12-14 12:53:15,234 - INFO - Epoch 1 | Batch 250/990 | Loss: 0.0816 | Accuracy: 0.7515 | Time: 232.25s
2024-12-14 12:53:37,989 - INFO - Epoch 1 | Batch 300/990 | Loss: 0.0990 | Accuracy: 0.7901 | Time: 255.01s
2024-12-14 12:54:05,297 - INFO - Epoch 1 | Batch 350/990 | Loss: 0.0074 | Accuracy: 0.8177 | Time: 282.32s
2024-12-14 12:54:33,287 - INFO - Epoch 1 | Batch 400/990 | Loss: 0.0192 | Accuracy: 0.8384 | Time: 310.31s
2024-12-14 12:55:04,678 - INFO - Epoch 1 | Batch 450/990 | Loss: 0.0140 | Accuracy: 0.8550 | Time: 341.70s
2024-12-14 12:55:33,665 - INFO - Epoch 1 | Batch 500/990 | Loss: 0.1895 | Accuracy: 0.8676 | Time: 370.68s
2024-12-14 12:56:09,238 - INFO - Epoch 1 | Batch 550/990 | Loss: 0.0121 | Accuracy: 0.8783 | Time: 406.26s
2024-12-14 12:56:31,047 - INFO - Epoch 1 | Batch 600/990 | Loss: 0.0035 | Accuracy: 0.8875 | Time: 428.07s
2024-12-14 12:57:00,546 - INFO - Epoch 1 | Batch 650/990 | Loss: 0.4893 | Accuracy: 0.8953 | Time: 457.57s
2024-12-14 12:57:25,707 - INFO - Epoch 1 | Batch 700/990 | Loss: 0.0214 | Accuracy: 0.9019 | Time: 482.73s
2024-12-14 12:57:46,333 - INFO - Epoch 1 | Batch 750/990 | Loss: 0.0016 | Accuracy: 0.9076 | Time: 503.35s
2024-12-14 12:58:38,576 - INFO - Epoch 1 | Batch 800/990 | Loss: 0.0063 | Accuracy: 0.9126 | Time: 555.60s
2024-12-14 12:59:16,783 - INFO - Epoch 1 | Batch 850/990 | Loss: 0.0071 | Accuracy: 0.9172 | Time: 593.80s
2024-12-14 12:59:37,568 - INFO - Epoch 1 | Batch 900/990 | Loss: 0.0038 | Accuracy: 0.9210 | Time: 614.59s
2024-12-14 13:00:05,016 - INFO - Epoch 1 | Batch 950/990 | Loss: 0.0049 | Accuracy: 0.9251 | Time: 642.04s
2024-12-14 13:00:22,685 - INFO - Epoch 1 completed | Avg Loss: 0.2606 | Accuracy: 0.9277
2024-12-14 13:01:41,442 - INFO - Validation | Loss: 0.0143 | Accuracy: 0.9960
2024-12-14 13:01:47,953 - INFO - New best model saved with validation loss: 0.0143
2024-12-14 13:01:48,332 - INFO - Epoch 2 | Batch 0/990 | Loss: 0.0027 | Accuracy: 1.0000 | Time: 0.38s
2024-12-14 13:02:08,980 - INFO - Epoch 2 | Batch 50/990 | Loss: 0.3761 | Accuracy: 0.9975 | Time: 21.03s
2024-12-14 13:02:51,359 - INFO - Epoch 2 | Batch 100/990 | Loss: 0.0010 | Accuracy: 0.9950 | Time: 63.41s
2024-12-14 13:03:11,030 - INFO - Epoch 2 | Batch 150/990 | Loss: 0.0020 | Accuracy: 0.9934 | Time: 83.08s
2024-12-14 13:03:34,158 - INFO - Epoch 2 | Batch 200/990 | Loss: 0.0016 | Accuracy: 0.9916 | Time: 106.20s
2024-12-14 13:04:05,450 - INFO - Epoch 2 | Batch 250/990 | Loss: 0.0027 | Accuracy: 0.9910 | Time: 137.50s
2024-12-14 13:04:24,232 - INFO - Epoch 2 | Batch 300/990 | Loss: 0.0014 | Accuracy: 0.9913 | Time: 156.28s
2024-12-14 13:05:23,855 - INFO - Epoch 2 | Batch 350/990 | Loss: 0.0007 | Accuracy: 0.9916 | Time: 215.90s
2024-12-14 13:05:45,186 - INFO - Epoch 2 | Batch 400/990 | Loss: 0.0121 | Accuracy: 0.9916 | Time: 237.23s
2024-12-14 13:06:44,439 - INFO - Epoch 2 | Batch 450/990 | Loss: 0.0012 | Accuracy: 0.9918 | Time: 296.48s
2024-12-14 13:07:08,810 - INFO - Epoch 2 | Batch 500/990 | Loss: 0.0092 | Accuracy: 0.9919 | Time: 320.86s
2024-12-14 13:07:54,937 - INFO - Epoch 2 | Batch 550/990 | Loss: 0.0089 | Accuracy: 0.9923 | Time: 366.98s
2024-12-14 13:08:17,205 - INFO - Epoch 2 | Batch 600/990 | Loss: 0.0035 | Accuracy: 0.9926 | Time: 389.25s
2024-12-14 13:08:35,293 - INFO - Epoch 2 | Batch 650/990 | Loss: 0.0006 | Accuracy: 0.9929 | Time: 407.34s
2024-12-14 13:09:08,098 - INFO - Epoch 2 | Batch 700/990 | Loss: 0.0076 | Accuracy: 0.9930 | Time: 440.14s
2024-12-14 13:09:31,070 - INFO - Epoch 2 | Batch 750/990 | Loss: 0.0011 | Accuracy: 0.9927 | Time: 463.12s
2024-12-14 13:10:36,598 - INFO - Epoch 2 | Batch 800/990 | Loss: 0.0082 | Accuracy: 0.9930 | Time: 528.64s
2024-12-14 13:11:05,410 - INFO - Epoch 2 | Batch 850/990 | Loss: 0.0022 | Accuracy: 0.9928 | Time: 557.46s
2024-12-14 13:11:28,090 - INFO - Epoch 2 | Batch 900/990 | Loss: 0.0005 | Accuracy: 0.9928 | Time: 580.14s
2024-12-14 13:11:53,158 - INFO - Epoch 2 | Batch 950/990 | Loss: 0.0019 | Accuracy: 0.9926 | Time: 605.20s
2024-12-14 13:12:06,875 - INFO - Epoch 2 completed | Avg Loss: 0.0274 | Accuracy: 0.9927
2024-12-14 13:13:05,178 - INFO - Validation | Loss: 0.0126 | Accuracy: 0.9977
2024-12-14 13:13:09,618 - INFO - New best model saved with validation loss: 0.0126
2024-12-14 13:13:10,098 - INFO - Epoch 3 | Batch 0/990 | Loss: 0.0056 | Accuracy: 1.0000 | Time: 0.48s
2024-12-14 13:13:33,084 - INFO - Epoch 3 | Batch 50/990 | Loss: 0.0007 | Accuracy: 0.9926 | Time: 23.46s
2024-12-14 13:13:52,621 - INFO - Epoch 3 | Batch 100/990 | Loss: 0.0013 | Accuracy: 0.9926 | Time: 43.00s
2024-12-14 13:14:14,195 - INFO - Epoch 3 | Batch 150/990 | Loss: 0.0017 | Accuracy: 0.9925 | Time: 64.58s
2024-12-14 13:15:00,603 - INFO - Epoch 3 | Batch 200/990 | Loss: 0.0006 | Accuracy: 0.9922 | Time: 110.98s
2024-12-14 13:15:25,210 - INFO - Epoch 3 | Batch 250/990 | Loss: 0.0054 | Accuracy: 0.9933 | Time: 135.59s
2024-12-14 13:16:02,843 - INFO - Epoch 3 | Batch 300/990 | Loss: 0.0012 | Accuracy: 0.9938 | Time: 173.22s
2024-12-14 13:17:04,082 - INFO - Epoch 3 | Batch 350/990 | Loss: 0.0059 | Accuracy: 0.9938 | Time: 234.46s
2024-12-14 13:17:30,590 - INFO - Epoch 3 | Batch 400/990 | Loss: 0.0014 | Accuracy: 0.9935 | Time: 260.97s
2024-12-14 13:18:15,713 - INFO - Epoch 3 | Batch 450/990 | Loss: 0.0011 | Accuracy: 0.9936 | Time: 306.09s
2024-12-14 13:18:40,496 - INFO - Epoch 3 | Batch 500/990 | Loss: 0.0006 | Accuracy: 0.9935 | Time: 330.88s
2024-12-14 13:19:15,132 - INFO - Epoch 3 | Batch 550/990 | Loss: 0.0037 | Accuracy: 0.9936 | Time: 365.51s
2024-12-14 13:19:47,848 - INFO - Epoch 3 | Batch 600/990 | Loss: 0.0005 | Accuracy: 0.9940 | Time: 398.23s
2024-12-14 13:20:42,693 - INFO - Epoch 3 | Batch 650/990 | Loss: 0.0013 | Accuracy: 0.9939 | Time: 453.07s
2024-12-14 13:21:14,025 - INFO - Epoch 3 | Batch 700/990 | Loss: 0.0110 | Accuracy: 0.9940 | Time: 484.41s
2024-12-14 13:21:33,600 - INFO - Epoch 3 | Batch 750/990 | Loss: 0.0015 | Accuracy: 0.9943 | Time: 503.98s
2024-12-14 13:21:56,388 - INFO - Epoch 3 | Batch 800/990 | Loss: 0.0162 | Accuracy: 0.9943 | Time: 526.77s
2024-12-14 13:22:20,075 - INFO - Epoch 3 | Batch 850/990 | Loss: 0.0009 | Accuracy: 0.9944 | Time: 550.46s
2024-12-14 13:22:41,943 - INFO - Epoch 3 | Batch 900/990 | Loss: 0.0013 | Accuracy: 0.9945 | Time: 572.32s
2024-12-14 13:23:10,100 - INFO - Epoch 3 | Batch 950/990 | Loss: 0.0015 | Accuracy: 0.9944 | Time: 600.48s
2024-12-14 13:23:27,265 - INFO - Epoch 3 completed | Avg Loss: 0.0218 | Accuracy: 0.9944
2024-12-14 13:24:19,183 - INFO - Validation | Loss: 0.0099 | Accuracy: 0.9972
2024-12-14 13:24:20,807 - INFO - New best model saved with validation loss: 0.0099
2024-12-14 13:27:49,973 - INFO - Final results saved to results_20241214_132749.json
2024-12-14 13:27:49,974 - INFO - 
Final Confusion Matrix:
2024-12-14 13:27:49,974 - INFO - 
[[  60    0    0    1    0    0    0    1]
 [   0   16    0    0    0    1    0    0]
 [   0    0  118    0    0    0    0    0]
 [   0    1    0  118    0    0    0    0]
 [   0    0    0    0 1258    0    1   15]
 [   0    0    0    0    1   93    0    1]
 [   0    0    0    0    0    0 1328    3]
 [   0    0    0    0    1    0    0 1380]]
2024-12-14 13:27:49,974 - INFO - 
Final Classification Report:
2024-12-14 13:27:49,974 - INFO - 
              precision    recall  f1-score   support

         cpp     1.0000    0.9677    0.9836        62
      groovy     0.9412    0.9412    0.9412        17
        java     1.0000    1.0000    1.0000       118
  javascript     0.9916    0.9916    0.9916       119
        json     0.9984    0.9874    0.9929      1274
      python     0.9894    0.9789    0.9841        95
         xml     0.9992    0.9977    0.9985      1331
         yml     0.9857    0.9993    0.9924      1381

    accuracy                         0.9941      4397
   macro avg     0.9882    0.9830    0.9855      4397
weighted avg     0.9941    0.9941    0.9941      4397

